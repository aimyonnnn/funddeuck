<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.itwillbs.test.mapper.BankMapper">
	<!-- 토큰 정보 저장 -->
	<insert id="insertToken" useGeneratedKeys="true" keyProperty="token.token_idx">
		INSERT
			INTO token
			VALUES (
				NULL
				, #{member_idx}
				, #{token.access_token}
				, #{token.token_type}
				, #{token.expires_in}
				, #{token.refresh_token}
				, #{token.scope}
				, #{token.user_seq_no}
			);
	</insert>
	
	<!-- 토큰 정보 조회 -->
	<select id="selectToken" resultType="com.itwillbs.test.vo.ResponseTokenVO">
		SELECT * 
			FROM token
				WHERE member_idx = #{member_idx}
			
	</select>
	
	<!-- 토큰 정보 업데이트 -->
	<update id="updateToken" parameterType="map">
		UPDATE token
		SET
			access_token = #{token.access_token},
			token_type = #{token.token_type},
			expires_in = #{token.expires_in},
			refresh_token = #{token.refresh_token},
			scope = #{token.scope},
			user_seq_no = #{token.user_seq_no} 
		WHERE 
			member_idx = #{member_idx} 
	</update>
	
	
	<!-- 계좌 정보 저장 -->
	<insert id="insertBankAccount">
		INSERT 
			INTO bankAccount
			VALUES (
				NULL
				, #{member_idx}
				, #{bankAccount.fintech_use_num}
				, #{bankAccount.account_holder_name}
				, #{bankAccount.bank_name}
				, #{bankAccount.account_num_masked}
			)
	
	</insert>	
	
	<!-- 계좌 정보 조회 -->
	<select id="selectBankAccount" resultType="com.itwillbs.test.vo.BankAccountVO">
		SELECT *
			FROM bankAccount
				WHERE member_idx = #{member_idx}
					AND fintech_use_num = #{bankAccount.fintech_use_num}
	</select>
	
	
</mapper>
